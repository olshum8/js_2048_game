var t,e={};const s=new((t=class{constructor(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.rows=4,this.columns=4,this.emptyCells=[],this.status="idle"}checkWin(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)2048===this.board[t][e]&&(this.status="win")}checkAvailableMoves(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)if(0===this.board[t][e]||t<this.rows-1&&this.board[t][e]===this.board[t+1][e]||e<this.columns-1&&this.board[t][e]===this.board[t][e+1])return!0;return!1}getEmptyCells(){this.emptyCells=[];for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)0===this.board[t][e]&&this.emptyCells.push([t,e]);return this.emptyCells}setRandomNum(){if(this.getEmptyCells(),0===this.emptyCells.length){this.checkAvailableMoves()||(this.status="lose");return}let t=Math.floor(Math.random()*this.emptyCells.length),[e,s]=this.emptyCells[t];this.board[e][s]=.9>Math.random()?2:4,this.checkWin(),this.checkAvailableMoves()||(this.status="lose")}slide(t){function e(){return t.filter(t=>0!==t)}t=e(t);for(let e=0;e<t.length-1;e++)t[e]===t[e+1]&&(t[e]*=2,t[e+1]=0,this.score+=t[e]);for(t=e(t);t.length<this.columns;)t.push(0);return t}isChanged(t){let e=this.getState();for(let s=0;s<e.length;s++)for(let i=0;i<e[s].length;i++)if(e[s][i]!==t[s][i])return!0;return!1}moveLeft(){let t=this.getState().map(t=>[...t]);for(let t=0;t<this.rows;t++){let e=this.board[t];e=this.slide(e),this.board[t]=e}this.isChanged(t)&&this.setRandomNum()}moveRight(){let t=this.getState().map(t=>[...t]);for(let t=0;t<this.rows;t++){let e=this.board[t];e.reverse(),(e=this.slide(e)).reverse(),this.board[t]=e}this.isChanged(t)&&this.setRandomNum()}moveUp(){let t=this.getState().map(t=>[...t]);for(let t=0;t<this.columns;t++){let e=[this.board[0][t],this.board[1][t],this.board[2][t],this.board[3][t]];e=this.slide(e),this.board[0][t]=e[0],this.board[1][t]=e[1],this.board[2][t]=e[2],this.board[3][t]=e[3]}this.isChanged(t)&&this.setRandomNum()}moveDown(){let t=this.getState().map(t=>[...t]);for(let t=0;t<this.columns;t++){let e=[this.board[0][t],this.board[1][t],this.board[2][t],this.board[3][t]];e.reverse(),(e=this.slide(e)).reverse(),this.board[0][t]=e[0],this.board[1][t]=e[1],this.board[2][t]=e[2],this.board[3][t]=e[3]}this.isChanged(t)&&this.setRandomNum()}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){this.status="playing",this.setRandomNum(),this.setRandomNum()}restart(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle"}}).__esModule?t.default:t),i=document.querySelector(".game-field"),r=document.querySelector(".game-score"),o=document.querySelector("#start-button"),a=document.querySelector("#restart-button"),d=document.querySelector(".message.message-win"),h=document.querySelector(".message.message-lose"),l=document.querySelector(".message.message-start");function n(){for(;i.firstChild;)i.removeChild(i.firstChild);for(let t of s.getState()){let e=document.createElement("tr");for(let s of(e.classList.add("field-row"),t)){let t=document.createElement("td");t.classList.add("field-cell"),0!==s&&(t.textContent=s,t.classList.add(`field-cell--${s}`)),e.appendChild(t)}i.appendChild(e),r.textContent=s.getScore()}switch(s.getStatus()){case"playing":document.addEventListener("keydown",c),l.classList.add("hidden");break;case"win":document.removeEventListener("keydown",c),d.classList.remove("hidden");break;case"lose":document.removeEventListener("keydown",c),h.classList.remove("hidden");break;case"idle":document.removeEventListener("keydown",c),l.classList.remove("hidden")}}function c(t){let e={UP:"ArrowUp",DOWN:"ArrowDown",LEFT:"ArrowLeft",RIGHT:"ArrowRight"};switch(t.key){case e.UP:s.moveUp();break;case e.DOWN:s.moveDown();break;case e.LEFT:s.moveLeft();break;case e.RIGHT:s.moveRight()}n()}"playing"===s.getStatus()&&document.addEventListener("keydown",c),o.addEventListener("click",function(){o.classList.add("hidden"),l.classList.add("hidden"),a.classList.remove("hidden"),s.start(),n()}),a.addEventListener("click",function(){a.classList.add("hidden"),o.classList.remove("hidden"),l.classList.add("hidden"),h.classList.add("hidden"),d.classList.add("hidden"),l.classList.remove("hidden"),s.restart(),n()}),n();
//# sourceMappingURL=index.1621cbc9.js.map
